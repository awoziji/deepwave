---

title: Preprocessing

keywords: fastai
sidebar: home_sidebar

summary: "Este modulo es el encargado de la carga, preprocesamiento y preparacion de los datos"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_preprocessing.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Imports">Imports<a class="anchor-link" href="#Imports">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Validacion-de-archivos">Validacion de archivos<a class="anchor-link" href="#Validacion-de-archivos">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_files" class="doc_header"><code>check_files</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L8" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_files</code>(<strong><code>folder_path</code></strong>, <strong><code>station</code></strong>=<em><code>'B2DF'</code></em>, <strong><code>channel</code></strong>=<em><code>'001'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Clase-Labels">Clase Labels<a class="anchor-link" href="#Clase-Labels">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Codigo">Codigo<a class="anchor-link" href="#Codigo">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Labels" class="doc_header"><code>class</code> <code>Labels</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L43" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Labels</code>(<strong><code>labels_path</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Ejemplos">Ejemplos<a class="anchor-link" href="#Ejemplos">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>labels = Labels("./data/B2DF/B2DF_labels.csv")</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ts = TimeSerie("./data/B2DF/B2DF_labels.csv", labels, "2m","30s")</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Clase-TimeSerie">Clase TimeSerie<a class="anchor-link" href="#Clase-TimeSerie">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Funciones-utiles">Funciones utiles<a class="anchor-link" href="#Funciones-utiles">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Obtener frecuencia de un archivo:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_freq_from_file" class="doc_header"><code>get_freq_from_file</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L82" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_freq_from_file</code>(<strong><code>file_path</code></strong>, <strong><code>station</code></strong>=<em><code>'B2DF'</code></em>, <strong><code>channel</code></strong>=<em><code>'001'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Cambiar frecuencia de los datos:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="change_data_frequency" class="doc_header"><code>change_data_frequency</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>change_data_frequency</code>(<strong><code>data</code></strong>, <strong><code>initial_freq</code></strong>, <strong><code>final_freq</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dividir un arreglo en varias ventanas:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_data" class="doc_header"><code>split_data</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L97" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_data</code>(<strong><code>data</code></strong>, <strong><code>window_size</code></strong>, <strong><code>step</code></strong>)</p>
</blockquote>
<p>Recibe un arreglo y lo divide en una matriz utilizando el tamaño de ventana y de paso definidos.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Cargar los datos:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_data_one_file" class="doc_header"><code>load_data_one_file</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L108" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_data_one_file</code>(<strong><code>file_path</code></strong>, <strong><code>freq</code></strong>=<em><code>500</code></em>, <strong><code>station</code></strong>=<em><code>'B2DF'</code></em>, <strong><code>channel</code></strong>=<em><code>'001'</code></em>)</p>
</blockquote>
<p>Busca en el camino del archivo pasado por parametros y
retorna un diccionario con la fecha de inicio y termino,
ademas de los datos correspondientes a la estacion y el canal pasados por parametros.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_data_list" class="doc_header"><code>load_data_list</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L124" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_data_list</code>(<strong><code>list_file_path</code></strong>, <strong><code>station</code></strong>=<em><code>'B2DF'</code></em>, <strong><code>channel</code></strong>=<em><code>'001'</code></em>, <strong><code>freq</code></strong>=<em><code>500</code></em>)</p>
</blockquote>
<p>Busca en cada camino de archivo de la lista pasado por parametros y
retorna una lista de diccionarios con las fecha de inicio y termino,
ademas de los datos correspondientes a la estacion y el canal pasados por parametros.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_data_folder" class="doc_header"><code>load_data_folder</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L137" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_data_folder</code>(<strong><code>folder_path</code></strong>, <strong><code>station</code></strong>=<em><code>'B2DF'</code></em>, <strong><code>channel</code></strong>=<em><code>'001'</code></em>, <strong><code>freq</code></strong>=<em><code>500</code></em>)</p>
</blockquote>
<p>Busca en cada archivo miniseed del directorio pasado por parametros y
retorna una lista de diccionarios con las fecha de inicio y termino,
ademas de los datos correspondientes a la estacion y el canal pasados por parametros.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Graficar datos:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_data" class="doc_header"><code>plot_data</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L148" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_data</code>(<strong><code>x_data</code></strong>, <strong><code>y_data</code></strong>, <strong><code>color</code></strong>, <strong><code>label</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Busqueda binaria en listas ordenadas:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="__binary_search" class="doc_header"><code>__binary_search</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L153" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>__binary_search</code>(<strong><code>item</code></strong>, <strong><code>data</code></strong>, <strong><code>ini</code></strong>, <strong><code>fin</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="binary_search" class="doc_header"><code>binary_search</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L166" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>binary_search</code>(<strong><code>item</code></strong>, <strong><code>data</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span>

<span class="k">assert</span> <span class="p">(</span><span class="n">binary_search</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">l</span><span class="p">),</span> <span class="n">binary_search</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="n">l</span><span class="p">),</span> <span class="n">binary_search</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span><span class="n">l</span><span class="p">))</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="k">assert</span> <span class="p">(</span><span class="n">binary_search</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">),</span> <span class="n">binary_search</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">l</span><span class="p">),</span> <span class="n">binary_search</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="n">l</span><span class="p">),</span> <span class="n">binary_search</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="n">l</span><span class="p">))</span> <span class="o">==</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_window_range" class="doc_header"><code>get_window_range</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L171" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_window_range</code>(<strong><code>ts</code></strong>, <strong><code>label</code></strong>, <strong><code>file_pos</code></strong>)</p>
</blockquote>
<p>Devuelve las ventanas donde empieza y termina el sismo</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_window" class="doc_header"><code>plot_window</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L187" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_window</code>(<strong><code>ts</code></strong>, <strong><code>label</code></strong>, <strong><code>file_pos</code></strong>, <strong><code>win_pos</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_all_windows" class="doc_header"><code>plot_all_windows</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L217" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_all_windows</code>(<strong><code>ts</code></strong>, <strong><code>label</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Codigo">Codigo<a class="anchor-link" href="#Codigo">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TimeSerie" class="doc_header"><code>class</code> <code>TimeSerie</code><a href="https://github.com/rubens36/deepwave/tree/master/deepwave/preprocessing.py#L228" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TimeSerie</code>(<strong><code>folder_path</code></strong>, <strong><code>labels</code></strong>:<a href="/deepwave/preprocessing#Labels"><code>Labels</code></a>=<em><code>None</code></em>, <strong><code>window_size</code></strong>:<code>str</code>=<em><code>'2m'</code></em>, <strong><code>step</code></strong>:<code>str</code>=<em><code>'30s'</code></em>)</p>
</blockquote>
<p>Estructura de datos que almacena las mediciones en una estacion.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Ejemplos:">Ejemplos:<a class="anchor-link" href="#Ejemplos:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Serie de tiempo con ventana de 2 minutos y paso de 30 segundos, el muestreo fue hecho a 50 Hz.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TIMESERIE_PATH = "./data/B2DF/raw"</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TimeSerie(TIMESERIE_PATH, "2m","30s")</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TimeSerie(TIMESERIE_PATH, "4s","2s")</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TimeSerie(TIMESERIE_PATH, "1h","30m")</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TimeSerie(TIMESERIE_PATH, "10","5")</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TimeSerie(TIMESERIE_PATH, "2m","30")</p>

</div>
</div>
</div>
</div>
 

